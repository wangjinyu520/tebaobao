(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/homeSon/shop_details"],{"08a4":function(t,i,n){"use strict";(function(t,o){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var e=s(n("a34a"));function s(t){return t&&t.__esModule?t:{default:t}}function a(t,i,n,o,e,s,a){try{var u=t[s](a),r=u.value}catch(c){return void n(c)}u.done?i(r):Promise.resolve(r).then(o,e)}function u(t){return function(){var i=this,n=arguments;return new Promise(function(o,e){var s=t.apply(i,n);function u(t){a(s,o,e,u,r,"next",t)}function r(t){a(s,o,e,u,r,"throw",t)}u(void 0)})}}var r=function(){return n.e("components/uni-number-box").then(n.bind(null,"6adc"))},c=function(){return n.e("graceUI/components/graceSwiper").then(n.bind(null,"fa4a"))},d=function(){return n.e("components/uni-countdown").then(n.bind(null,"0b3c"))},h=null,f="",p=[],g=(new Date,{onLoad:function(t){h=t.id,this.goodsId=t.id,this.rush_id=t.rush_id,this.userCartNum=this.$store.state.userCartNum,this.getgoodsinfoList(),p=[]},data:function(){return{heightImg:"330px",datainfo:{uniattr:[]},swiperItems:[],product:"",shopinfos:"",guige:"",couponinfos:"",remgoodres:"",huodong:"",sertions:"",radioattr:[],getcouponlst:[],huodonginfo:"",serlst:[],goodsId:null,colores:[],activity_info:"",active:1,proNumber:0,buyNum:1,activity_time:{},pin_id:"",tuan_id:"",PopupIndex:0,userList:[],userCartNum:0,choosePinNum:"",isPT:"",isJoin:!1,skeleton:"show",valueStatus:0}},computed:{avatarList:function(){return 1==this.activity_info.assem_type?2===this.activity_info.zhuangtai?{imgs:this.activity_info.member_assem,title:"拼团成功"}:{imgs:this.activity_info.member_assem,title:"开团后邀请好友组团"}:2==this.activity_info.assem_type?{imgs:this.activity_info.member_assem,title:1==this.activity_info.member_assem[0].pin_type?"欢迎来到".concat(this.activity_info.member_assem[0].user_name,"开的团"):"欢迎参团"}:3==this.activity_info.assem_type?{imgs:this.activity_info.member_assem,title:"邀请好友参团"}:void 0},getBtnText:function(){return 1!=this.activity_info.assem_type||this.isJoin?2==this.activity_info.assem_type||this.isJoin?"立即参团":3!=this.activity_info.assem_type||this.isJoin?void 0:"邀请好友":"发起拼团"},getPrice:function(){return 2==this.isPT||""==this.isPT?"￥".concat(this.product.zs_shop_price):1==this.isPT?"￥".concat(this.activity_info.dandu_price):void 0}},mounted:function(){},onShow:function(){},watch:{},methods:{closePopup:function(){this.isJoin=!1},join:function(t){this.isJoin=!0,this.PopupIndex=5,this.isPT=2,this.choosePinNum=t,this.$refs.popupRef.show()},hidePopup:function(){this.isJoin=!1,this.$refs.popupRef.close()},coupon:function(){var t=u(e.default.mark(function t(i){var n=this;return e.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.PopupIndex=i,this.$refs.popupRef.show(),1===this.PopupIndex&&(this.$loading(),this.$http.getcouponlst({shop_id:this.product.shop_id}).then(function(t){200==t.status&&(n.getcouponlst=t.data)})),2===this.PopupIndex&&(this.$loading(),this.$http.gethuodonginfo({shop_id:this.product.shop_id,goods_id:h,prom_id:this.huodong.prom_id}).then(function(t){200==t.status&&(n.huodonginfo=t.data)})),3===this.PopupIndex&&(this.$loading(),this.$http.getserlst({shop_id:this.product.shop_id,goods_id:h}).then(function(t){200==t.status&&(n.serlst=t.data)}));case 5:case"end":return t.stop()}},t,this)}));function i(i){return t.apply(this,arguments)}return i}(),Receive:function(t){var i=this,n=this.getIsLogin();if(!n)return!1;this.$loading(),this.$http.getcoupons({coupon_id:t,shop_id:this.product.shop_id}).then(function(n){200==n.status&&(i.$toast(n.mess),i.getcouponlst.forEach(function(i){i.id==t&&(i.have=1)}))})},getgoodsinfoList:function(){var i=this;this.$loading(),this.$http.getgoodsinfo({goods_id:h,rush_id:this.rush_id}).then(function(n){if(200==n.status){if(i.datainfo=n.data,i.swiperItems=n.data.gpres,i.product=n.data.goodsinfo,i.shopinfos=n.data.shopinfos,i.couponinfos=n.data.couponinfos,i.huodong=n.data.huodong,i.sertions=n.data.sertions,i.radioattr=n.data.radioattr,i.proNumber=n.data.pronum,i.pin_id=n.data.pin_id,i.tuan_id=n.data.tuan_id,i.userList=n.data.memberpinres,i.remgoodres=n.data.remgoodres,i.guige=n.data.guige.join(","),0!=n.data.activity_info.length&&(i.activity_info=n.data.activity_info),i.colores=n.data.colores.length>5?n.data.colores.slice(0,5):n.data.colores,n.data.activity_info.end_time){var e=Number(i.activity_info.end_time)-Number(i.activity_info.dqtime),s=i.$formatSeconds(e).split("-");i.activity_time={day:parseInt(s[0]/24),hour:parseInt(s[0]%24),minute:parseInt(s[1]),second:parseInt(s[2])}}else i.activity_time="";var a="";if(n.data.goods_attr){var u=n.data.goods_attr.split(",");p=n.data.goods_attr.split(",");var r=!0,c=!1,d=void 0;try{for(var h,f=function(){var t=h.value;i.radioattr=n.data.radioattr.map(function(i){var o=i.map(function(i){return i.id==t&&(i.check="true",n.data.guige.forEach(function(t,o){if(t===i.attr_name){var e=n.data.guige.length-1===o?"":",";a=a+t+":"+i.attr_value+e}})),i});return o})},g=u[Symbol.iterator]();!(r=(h=g.next()).done);r=!0)f()}catch(_){c=!0,d=_}finally{try{r||null==g.return||g.return()}finally{if(c)throw d}}}i.radioattr=n.data.radioattr.map(function(t){var n=t.map(function(n){return 1===t.length&&(n.check="true",p.push(n.id),i.guige="".concat(i.guige,":").concat(n.attr_value)),n});return n}),setTimeout(function(){var n=t.createSelectorQuery().select(".image_height");n.fields({size:!0,scrollOffset:!0},function(t){o("log",t," at pages\\homeSon\\shop_details.vue:705"),t&&t.height>330&&(i.heightImg=t.height+"px")}).exec()},200),setTimeout(function(){i.skeleton="hide"},200),i.statusMath(i)}})},showInfo:function(t){this.active=t},buyNow:function(t,i){if("邀请好友"===this.getBtnText&&"guige"!==t&&2===i)return this.getnav("/pages/homeSon/invite?pin_id=".concat(this.pin_id,"&tuan_id=").concat(this.tuan_id)),!1;"guige"===t&&3==this.product.is_activity||(this.PopupIndex=5,this.isPT=i,this.$refs.popupRef.show(),f=t)},submitOrder:function(t,i){if("邀请好友"===this.getBtnText&&"guige"!==i&&2===i)return this.getnav("/pages/homeSon/invite?pin_id=".concat(this.pin_id,"&tuan_id=").concat(this.tuan_id)),!1;f?this.attrSubmit(i):(f=t,this.attrSubmit(i))},attrSubmit:function(t){var i=this,n=this.getIsLogin();if(!n)return!1;var o={};o="立即参团"===this.getBtnText?{goods_id:h,goods_attr:p.join(","),num:this.buyNum,fangshi:2,pin_number:this.choosePinNum}:{goods_id:h,goods_attr:p.join(","),num:this.buyNum,fangshi:t},this.$loading(),f?this.$http.getaddcart(o).then(function(t){200==t.status&&(i.$toast(t.mess),i.$store.dispatch("contentnum"),i.$refs.popupRef.close(),setTimeout(function(){i.userCartNum=i.$store.state.userCartNum},800))}):this.$http.getpurbuy(o).then(function(t){200==t.status&&i.getnav("/pages/homeSon/ConfirmationOrder?pur_id=".concat(t.data.pur_id,"&type=1&fangshi=").concat(t.data.fangshi,"&pin_number=").concat(t.data.pin_number))})},closeAttr:function(){this.isJoin=!1,this.$refs.popupRef.close()},typeChange:function(t,i){var n=this,o=this.radioattr;p=[];var e=[];for(var s in o)if(i==s)for(var a=0;a<o[s].length;a++)o[s][a].id==t&&o[s][a].attr_pic&&this.$set(this.product,"thumb_url",o[s][a].attr_pic),o[s][a].id==t?(o[s][a].check="true",e.includes(o[s][a].attr_name+":"+o[s][a].attr_value)||e.push(o[s][a].attr_name+":"+o[s][a].attr_value)):o[s][a].check="false";for(var u in o)for(a=0;a<o[u].length;a++)"true"==o[u][a].check&&(p.push("".concat(o[u][a].id)),e.includes(o[u][a].attr_name+":"+o[u][a].attr_value)||e.push(o[u][a].attr_name+":"+o[u][a].attr_value));if(Object.keys(o).length==p.length){var r=1==this.isPT||2==this.isPT&&3===this.product.is_activity||""==this.isPT&&3===this.product.is_activity?"getpingoodsPrice":"getgoodsPrice";this.$http[r]({goods_attr:p.join(","),goods_id:h,fangshi:1!=this.isPT&&3==this.product.is_activity?2:1}).then(function(t){if(200==t.status)if(n.proNumber=t.data.attrinfos.goods_number,n.pin_id=t.data.pin_id,n.tuan_id=t.data.tuan_id,n.guige=e.join(","),n.isJoin=!1,n.userList=t.data.memberpinres,0!=t.data.activity_info.length&&(n.activity_info=t.data.activity_info),n.buyNum=1,(1!=t.data.fangshi&&1!=n.isPT||!n.isPT||2==n.isPT&&1==t.data.fangshi)&&(n.product.is_activity=t.data.attrinfos.is_activity),n.product.goods_name=t.data.attrinfos.goods_name,n.product.zs_shop_price=t.data.attrinfos.zs_shop_price,n.product.thumb_url=t.data.attrinfos.attr_pic?t.data.attrinfos.attr_pic:n.product.thumb_url,t.data.activity_info.end_time){var i=Number(n.activity_info.end_time)-Number(n.activity_info.dqtime),o=n.$formatSeconds(i).split("-");n.activity_time={day:parseInt(o[0]/24),hour:o[0]%24,minute:o[1],second:o[2]}}else n.activity_time=""})}},buyNumChange:function(t,i){this.buyNum=t},securities:function(){t.navigateTo({url:"/pages/subPage/Coupon"})},timeuptime:function(){this.$toast("秒杀结束"),this.getgoodsinfoList(),p=[]},getTab:function(i){t.switchTab({url:i})},getIsLogin:function(){return!!t.getStorageSync("token")||(t.redirectTo({url:"/pages/loginSon/login?islogin=0"}),!1)},chat:function(){if(!t.getStorageSync("token"))return this.getnav("/pages/loginSon/login"),!1;this.getnav("/pages/businessSon/chat?toId="+this.datainfo.goodsinfo.shop_token)},home:function(){var t=this,i=this.getIsLogin();if(!i)return!1;1==this.product.coll_goods?(this.$loading(),this.$http.getcancelcoll({goods_id:h}).then(function(i){200==i.status&&(t.$toast(i.mess),t.product.coll_goods=0)})):(this.$loading(),this.$http.getcoll({goods_id:h}).then(function(i){200==i.status&&(t.$toast(i.mess),t.product.coll_goods=1)}))}},components:{graceSwiper:c,uniNumberBox:r,uniCountdown:d}});i.default=g}).call(this,n("6e42")["default"],n("0de9")["default"])},"142f":function(t,i,n){"use strict";n.r(i);var o=n("08a4"),e=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(i,t,function(){return o[t]})}(s);i["default"]=e.a},"5ff5":function(t,i,n){"use strict";var o,e=function(){var t=this,i=t.$createElement;t._self._c},s=[];n.d(i,"b",function(){return e}),n.d(i,"c",function(){return s}),n.d(i,"a",function(){return o})},"7dd1":function(t,i,n){"use strict";(function(t){n("fdb5"),n("921b");o(n("66fd"));var i=o(n("caa4"));function o(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,n("6e42")["createPage"])},aeb5:function(t,i,n){"use strict";var o=n("ba9f"),e=n.n(o);e.a},ba9f:function(t,i,n){},caa4:function(t,i,n){"use strict";n.r(i);var o=n("5ff5"),e=n("142f");for(var s in e)"default"!==s&&function(t){n.d(i,t,function(){return e[t]})}(s);n("aeb5");var a,u=n("f0c5"),r=Object(u["a"])(e["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],a);i["default"]=r.exports}},[["7dd1","common/runtime","common/vendor"]]]);